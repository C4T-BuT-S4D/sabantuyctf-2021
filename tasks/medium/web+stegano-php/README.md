# medium | web + stegano | Hide and Seek

## Название

Hide and Seek

## Описание

> Мой друг написал сайт для сохранения секретиков внутрь картинок, причем секреты совершенно не видны.
>
> Говорит, что скоро сделает возможность доставать секреты из картинок, но пока можно и так юзать. 
> 
> Найдете флаг ?
>
> _Формат флага: `Sabantuy{[A-Za-z0-9_]+}`._
## Деплой

`cd deploy && docker-compose up --build -d`

## Файлы

Уччастникам нужно выдать ссылку на приложение, порт = 40400.

## Решение

Перед нами сервис, который позволяет загрузить картинку и текст и получить изображение, содержащее стего-контейнер.

При этом можно не только загружать текст, но и встраивать текст по URL.

При попытке отправить **"xxx"** в качестве URL, получим ошибку функции `file_get_contents()`, что означает возможность уязвимости LFD.

Метод стеганографии достаточно легко вычислить, так как мы имеем оригинальное изображение (мы же его сами выбираем), текст и изображение-контейнер.

Достаточно сделать diff двух картинок, чтобы понять что перед нами **LSB в 4 бита на пиксель** (2 младших красных и синих). 

Далее эксплуатация сводится к следующим шагам:
1. Создать контейнер с содержимым файла `./index.php`.
2. Достать текст из контейнера (получить исходный код `index.php`).
3. Найти в `index.php` простой бэкдор для флага и пройти его (обойти strcmp).

## Флаг

```
Sabantuy{w0w_y0u_kn0w_st3gan0_and_w3b}
```