# hard | reverse | erawlam

## Название

Erawlam

## Описание

> Нашу картинку с флагом зашифровала эта программа. Мы не знаем, что делать, кажется флаг уже не вернуть
> 
> _Формат флага: `Sabantuy{...}`._

## Деплой

Деплой не требуется.

## Файлы

Участникам нужно выдать содержимое папки [public/](public/).

## Решение

Участникам дан исполняемый файл под Windows. Данный файл реализует шифрование файла `flag.png` и превращает его в `flag_enc.png`.

У участников есть только зашифрованный файл. Внутри исполняемого файла можно найти довольно сложный код. С поомщью отладчика можно выяснить, что первые 16 байта входного файла проходят через операцию XOR с числом 0x42. После чего от них вычислается SHA1 хэш. Полученное значение используется для создания ключа для AES128. Далее каждый блок файла шифруется и записывается в выходной файл, длина блока равна 16 байт. 

В исполняемом файле применена техника поиска функций по хэшам от их имени, однако её можно полностью невелировать с помощью отладчика, т.к. приёмов анти-отладки не применялось.

Исходный код решения [solve/Source.cpp](solve/Source.cpp)
Исполняемый файл расшифровывающий картинку: [solve/ErawlamSolution.exe](solve/ErawlamSolution.exe)

## Флаг

```
Sabantuy{y0u_4r3_v3ry_g00d_1n_w1nd0ws_r3v3rs3}
```
