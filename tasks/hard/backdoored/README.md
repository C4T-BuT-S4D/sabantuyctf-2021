# hard | forensics | backdoored

## Название

Backdoored

## Описание

> Кажется нам залили бекдор, может быть даже не один. У нас есть трафик, разберёшься, что случилось?
> 
> Мы также нашли какой-то архив на своей системе, но он зашифрован. Может у тебя получится его расшифровать?
> 
> _Формат флага: `Sabantuy{...}`._

## Деплой

Деплой не требуется.

## Файлы

Участникам нужно выдать содержимое папки [public/](public/).

## Решение

Участникам предоставлен дамп, внутри которого можно найти reverse-tcp-shell на порт 4444. В данном стриме можно найти скачивание некоторого файла с pastebin.

После скачивания файл запускается и выводятся некоторые строки. Файл не доступен для скачивания, пототому что был удалён. Однако у участников есть некоторый архив в котором лежит python-скрипт. Архив под паролем, но без сжатия. Т.к. скрипт был запущен через "./" можно предположить, что у него есть шебанг.

Шебанг можно использовать в качестве открытого текста для атаки на несжатый зашифрованный zip-архив. 

В качестве инструмента для атаки на архив будем использовать [bkcrack](https://github.com/kimci86/bkcrack)

Атака занимает примерно 5 минут.

Получая скрипт анализируем код и достаём нужные нам данные для расшифровки трафика.

Пример решения: [solve/solution.py](solve/solution.py)

## Флаг

```
Sabantuy{9b139206ab5141d4696901d95ca69a01}
```
